# ç°æœ‰æµ‹è¯•è„šæœ¬ä½¿ç”¨æŒ‡å—

<cite>
**æœ¬æ–‡æ¡£ä¸­å¼•ç”¨çš„æ–‡ä»¶**
- [test.js](file://test.js)
- [debug-api.js](file://debug-api.js)
- [src/routes/auth.ts](file://src/routes/auth.ts)
- [src/routes/blocks.ts](file://src/routes/blocks.ts)
- [src/routes/system.ts](file://src/routes/system.ts)
- [src/config/index.ts](file://src/config/index.ts)
- [README.md](file://README.md)
</cite>

## ç›®å½•
1. [ç®€ä»‹](#ç®€ä»‹)
2. [æµ‹è¯•è„šæœ¬æ¦‚è¿°](#æµ‹è¯•è„šæœ¬æ¦‚è¿°)
3. [æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•](#æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•)
4. [æµ‹è¯•ç”¨ä¾‹ç»“æ„è¯¦è§£](#æµ‹è¯•ç”¨ä¾‹ç»“æ„è¯¦è§£)
5. [è®¤è¯æœºåˆ¶å®ç°](#è®¤è¯æœºåˆ¶å®ç°)
6. [HTTPè¯·æ±‚å°è£…](#httpè¯·æ±‚å°è£…)
7. [æ‰§è¡Œæµç¨‹åˆ†æ](#æ‰§è¡Œæµç¨‹åˆ†æ)
8. [è¾“å‡ºç»“æœè§£è¯»](#è¾“å‡ºç»“æœè§£è¯»)
9. [æ•…éšœæ’é™¤æŒ‡å—](#æ•…éšœæ’é™¤æŒ‡å—)
10. [æœ€ä½³å®è·µå»ºè®®](#æœ€ä½³å®è·µå»ºè®®)

## ç®€ä»‹

Point-Tron ç³»ç»Ÿæä¾›äº†ä¸€ä¸ªä¸“é—¨çš„æµ‹è¯•è„šæœ¬ `test.js`ï¼Œç”¨äºå¯¹æ•´ä¸ªç³»ç»Ÿçš„ç«¯åˆ°ç«¯åŠŸèƒ½è¿›è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚è¯¥è„šæœ¬é€šè¿‡ HTTP å®¢æˆ·ç«¯æ¨¡æ‹ŸçœŸå®ç”¨æˆ·æ“ä½œï¼ŒéªŒè¯ç³»ç»Ÿçš„æ ¸å¿ƒåŠŸèƒ½æ¨¡å—ï¼ŒåŒ…æ‹¬å¥åº·æ£€æŸ¥ã€ç”¨æˆ·è®¤è¯ã€æ•°æ®ç»Ÿè®¡ã€ç³»ç»ŸçŠ¶æ€ç­‰å…³é”®ç‰¹æ€§ã€‚

æµ‹è¯•è„šæœ¬é‡‡ç”¨ç®€æ´çš„è®¾è®¡ç†å¿µï¼Œé€šè¿‡é¢„å®šä¹‰çš„æµ‹è¯•ç”¨ä¾‹æ•°ç»„æ¥ç»„ç»‡æµ‹è¯•é€»è¾‘ï¼Œæ”¯æŒè®¤è¯ä»¤ç‰Œçš„è‡ªåŠ¨ç®¡ç†å’Œè·¨è¯·æ±‚ä¼ é€’ï¼Œæä¾›äº†ç›´è§‚çš„æµ‹è¯•ç»“æœåé¦ˆæœºåˆ¶ã€‚

## æµ‹è¯•è„šæœ¬æ¦‚è¿°

### è„šæœ¬æ¶æ„

```mermaid
flowchart TD
Start([å¼€å§‹æ‰§è¡Œæµ‹è¯•]) --> LoadConfig["åŠ è½½åŸºç¡€é…ç½®<br/>BASE_URL = http://localhost:3000"]
LoadConfig --> InitVars["åˆå§‹åŒ–å˜é‡<br/>authToken = ''"]
InitVars --> TestLoop["éå†æµ‹è¯•ç”¨ä¾‹æ•°ç»„"]
TestLoop --> BuildRequest["æ„å»ºHTTPè¯·æ±‚"]
BuildRequest --> AddAuth{"æ˜¯å¦éœ€è¦è®¤è¯?"}
AddAuth --> |æ˜¯| AddToken["æ·»åŠ Authorizationå¤´"]
AddAuth --> |å¦| SendRequest["å‘é€è¯·æ±‚"]
AddToken --> SendRequest
SendRequest --> ProcessResponse["å¤„ç†å“åº”"]
ProcessResponse --> SaveToken{"æ˜¯å¦ä¿å­˜ä»¤ç‰Œ?"}
SaveToken --> |æ˜¯| UpdateToken["æ›´æ–°authToken"]
SaveToken --> |å¦| CheckStatus["æ£€æŸ¥çŠ¶æ€ç "]
UpdateToken --> CheckStatus
CheckStatus --> ValidateResult{"éªŒè¯ç»“æœ"}
ValidateResult --> |é€šè¿‡| LogSuccess["è®°å½•æˆåŠŸ"]
ValidateResult --> |å¤±è´¥| LogFailure["è®°å½•å¤±è´¥"]
LogSuccess --> NextTest{"è¿˜æœ‰æµ‹è¯•?"}
LogFailure --> NextTest
NextTest --> |æ˜¯| TestLoop
NextTest --> |å¦| GenerateReport["ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š"]
GenerateReport --> End([ç»“æŸ])
```

**å›¾è¡¨æ¥æº**
- [test.js](file://test.js#L1-L137)

### ä¸»è¦ç‰¹æ€§

1. **è‡ªåŠ¨åŒ–æµ‹è¯•æ‰§è¡Œ**ï¼šæ— éœ€äººå·¥å¹²é¢„ï¼Œè‡ªåŠ¨æ‰§è¡Œæ‰€æœ‰é¢„å®šä¹‰æµ‹è¯•ç”¨ä¾‹
2. **è®¤è¯ä»¤ç‰Œç®¡ç†**ï¼šè‡ªåŠ¨å¤„ç†ç™»å½•è·å–ä»¤ç‰Œå¹¶åœ¨åç»­è¯·æ±‚ä¸­ä¼ é€’
3. **çŠ¶æ€ç éªŒè¯**ï¼šç²¾ç¡®éªŒè¯æ¯ä¸ªæ¥å£çš„é¢„æœŸ HTTP çŠ¶æ€ç 
4. **å“åº”æ•°æ®è§£æ**ï¼šè‡ªåŠ¨è§£æ JSON å“åº”å¹¶æ˜¾ç¤ºå…³é”®æ•°æ®
5. **é”™è¯¯å¤„ç†æœºåˆ¶**ï¼šå®Œå–„çš„å¼‚å¸¸æ•è·å’Œé”™è¯¯æŠ¥å‘Š
6. **å¯è§†åŒ–ç»“æœ**ï¼šä½¿ç”¨ç¬¦å·è¡¨æƒ…æä¾›ç›´è§‚çš„æµ‹è¯•ç»“æœå±•ç¤º

**ç« èŠ‚æ¥æº**
- [test.js](file://test.js#L1-L137)

## æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•

### å¥åº·æ£€æŸ¥æµ‹è¯•

å¥åº·æ£€æŸ¥æ˜¯ç³»ç»Ÿå¯ç”¨æ€§çš„åŸºæœ¬éªŒè¯ï¼Œç¡®ä¿æœåŠ¡å™¨èƒ½å¤Ÿæ­£å¸¸å“åº”ã€‚

```javascript
{
  name: 'å¥åº·æ£€æŸ¥',
  method: 'GET',
  path: '/health',
  expectedStatus: 200
}
```

**æµ‹è¯•ç›®çš„**ï¼šéªŒè¯ç³»ç»ŸåŸºç¡€æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
**é¢„æœŸç»“æœ**ï¼šHTTP 200 çŠ¶æ€ç è¡¨ç¤ºç³»ç»Ÿå¥åº·
**å®é™…åº”ç”¨**ï¼šä½œä¸ºå…¶ä»–æµ‹è¯•çš„å‰ææ¡ä»¶ï¼Œç¡®ä¿ç³»ç»Ÿå¯è®¿é—®

### ç”¨æˆ·è®¤è¯æµ‹è¯•

ç”¨æˆ·ç™»å½•åŠŸèƒ½éªŒè¯ç³»ç»Ÿè®¤è¯æœºåˆ¶çš„æœ‰æ•ˆæ€§ã€‚

```javascript
{
  name: 'ç™»å½•æµ‹è¯•',
  method: 'POST',
  path: '/api/auth/login',
  data: { username: 'admin', password: 'admin123' },
  expectedStatus: 200,
  saveToken: true
}
```

**æµ‹è¯•ç‰¹ç‚¹**ï¼š
- ä½¿ç”¨é»˜è®¤ç®¡ç†å‘˜å‡­æ®è¿›è¡Œç™»å½•
- è‡ªåŠ¨ä¿å­˜è¿”å›çš„ JWT ä»¤ç‰Œ
- ä¸ºåç»­è®¤è¯ç›¸å…³æµ‹è¯•å‡†å¤‡å‡­è¯

### åŒºå—ç»Ÿè®¡è·å–æµ‹è¯•

éªŒè¯å®æ—¶åŒºå—æ•°æ®ç»Ÿè®¡åŠŸèƒ½çš„å‡†ç¡®æ€§ã€‚

```javascript
{
  name: 'è·å–åŒºå—ç»Ÿè®¡',
  method: 'GET',
  path: '/api/blocks/stats',
  expectedStatus: 200,
  requireAuth: true
}
```

**æ•°æ®å±•ç¤º**ï¼šç³»ç»Ÿä¼šæ˜¾ç¤ºä»Šæ—¥ç»Ÿè®¡è¯¦æƒ…
- æ€»åŒºå—æ•°é‡
- å•æ•°åŒºå—æ•°é‡
- åŒæ•°åŒºå—æ•°é‡
- å°æ—¶çº§ç»Ÿè®¡æ•°æ®

### ç³»ç»ŸçŠ¶æ€æŸ¥è¯¢æµ‹è¯•

è·å–ç³»ç»Ÿæ•´ä½“è¿è¡ŒçŠ¶æ€ä¿¡æ¯ã€‚

```javascript
{
  name: 'è·å–ç³»ç»ŸçŠ¶æ€',
  method: 'GET',
  path: '/api/system/status',
  expectedStatus: 200,
  requireAuth: true
}
```

**çŠ¶æ€ä¿¡æ¯**ï¼š
- RPC è½®è¯¢çŠ¶æ€
- æ•°æ®åº“è¿æ¥çŠ¶æ€
- å†…å­˜ä½¿ç”¨æƒ…å†µ
- ç³»ç»Ÿè¿è¡Œæ—¶é—´

**ç« èŠ‚æ¥æº**
- [test.js](file://test.js#L11-L43)

## æµ‹è¯•ç”¨ä¾‹ç»“æ„è¯¦è§£

### å­—æ®µè¯´æ˜

æµ‹è¯•ç”¨ä¾‹æ•°ç»„ä¸­çš„æ¯ä¸ªå¯¹è±¡éƒ½åŒ…å«ä»¥ä¸‹å…³é”®å­—æ®µï¼š

#### åŸºç¡€å­—æ®µ

1. **name** (`string`)ï¼šæµ‹è¯•ç”¨ä¾‹çš„æè¿°æ€§åç§°
   - ç¤ºä¾‹ï¼š`'å¥åº·æ£€æŸ¥'`, `'ç™»å½•æµ‹è¯•'`, `'è·å–åŒºå—ç»Ÿè®¡'`

2. **method** (`string`)ï¼šHTTP è¯·æ±‚æ–¹æ³•
   - æ”¯æŒï¼š`'GET'`, `'POST'`, `'PUT'`, `'DELETE'`

3. **path** (`string`)ï¼šAPI è·¯å¾„
   - ç¤ºä¾‹ï¼š`'/health'`, `'/api/auth/login'`, `'/api/blocks/stats'`

4. **expectedStatus** (`number`)ï¼šæœŸæœ›çš„ HTTP çŠ¶æ€ç 
   - å¸¸è§å€¼ï¼š`200` (æˆåŠŸ), `401` (æœªæˆæƒ), `404` (æœªæ‰¾åˆ°)

#### å¯é€‰å­—æ®µ

5. **data** (`object`)ï¼šPOST è¯·æ±‚çš„è¯·æ±‚ä½“æ•°æ®
   - ç”¨äºç™»å½•ã€åˆ›å»ºèµ„æºç­‰éœ€è¦å‘é€æ•°æ®çš„è¯·æ±‚
   - ç¤ºä¾‹ï¼š`{ username: 'admin', password: 'admin123' }`

6. **requireAuth** (`boolean`)ï¼šæ˜¯å¦éœ€è¦è®¤è¯
   - è®¾ç½®ä¸º `true` æ—¶ï¼Œè‡ªåŠ¨åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ è®¤è¯ä¿¡æ¯
   - è‡ªåŠ¨ä½¿ç”¨å½“å‰å­˜å‚¨çš„ `authToken`

7. **saveToken** (`boolean`)ï¼šæ˜¯å¦ä¿å­˜è¿”å›çš„ä»¤ç‰Œ
   - ä»…é€‚ç”¨äºç™»å½•æ¥å£
   - è‡ªåŠ¨æå–å¹¶æ›´æ–°å…¨å±€ `authToken` å˜é‡

### ç»“æ„è®¾è®¡åŸç†

```mermaid
classDiagram
class TestCase {
+string name
+string method
+string path
+number expectedStatus
+object data
+boolean requireAuth
+boolean saveToken
+execute() TestResult
+validate(response) boolean
}
class TestRunner {
-TestCase[] tests
-string authToken
+runAll() TestReport
+processTest(test) TestResult
+buildRequest(test) HttpRequest
}
class TestResult {
+boolean passed
+number statusCode
+object responseData
+string errorMessage
+string displayMessage
}
TestRunner --> TestCase : "manages"
TestRunner --> TestResult : "generates"
TestCase --> TestResult : "produces"
```

**å›¾è¡¨æ¥æº**
- [test.js](file://test.js#L11-L43)

**ç« èŠ‚æ¥æº**
- [test.js](file://test.js#L11-L43)

## è®¤è¯æœºåˆ¶å®ç°

### ä»¤ç‰Œä¼ é€’æœºåˆ¶

æµ‹è¯•è„šæœ¬å®ç°äº†å®Œæ•´çš„ JWT ä»¤ç‰Œç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼š

```mermaid
sequenceDiagram
participant Script as "æµ‹è¯•è„šæœ¬"
participant Server as "Point-TronæœåŠ¡å™¨"
participant Global as "å…¨å±€å˜é‡"
Script->>Server : POST /api/auth/login
Server-->>Script : {token : "jwt_token", user : {...}}
Script->>Global : authToken = jwt_token
Script->>Server : GET /api/blocks/stats<br/>Authorization : Bearer jwt_token
Server-->>Script : {success : true, data : {...}}
Script->>Server : GET /api/system/status<br/>Authorization : Bearer jwt_token
Server-->>Script : {success : true, data : {...}}
```

**å›¾è¡¨æ¥æº**
- [test.js](file://test.js#L75-L85)
- [src/routes/auth.ts](file://src/routes/auth.ts#L15-L40)

### è®¤è¯å¤´æ·»åŠ é€»è¾‘

```javascript
// æ·»åŠ è®¤è¯å¤´
if (test.requireAuth && authToken) {
  options.headers['Authorization'] = `Bearer ${authToken}`;
}
```

**å®ç°ç‰¹ç‚¹**ï¼š
1. **æ¡ä»¶æ£€æŸ¥**ï¼šåªæœ‰å½“æµ‹è¯•ç”¨ä¾‹è®¾ç½® `requireAuth: true` ä¸”å·²æœ‰æœ‰æ•ˆä»¤ç‰Œæ—¶æ‰æ·»åŠ è®¤è¯å¤´
2. **ä»¤ç‰Œæ ¼å¼**ï¼šä½¿ç”¨æ ‡å‡†çš„ `Bearer` è®¤è¯æ–¹æ¡ˆ
3. **è‡ªåŠ¨ä¼ é€’**ï¼šåç»­æ‰€æœ‰éœ€è¦è®¤è¯çš„è¯·æ±‚éƒ½ä¼šè‡ªåŠ¨æºå¸¦æœ€æ–°çš„ä»¤ç‰Œ

### ä»¤ç‰Œä¿å­˜æœºåˆ¶

```javascript
// ä¿å­˜ä»¤ç‰Œ
if (test.saveToken && response.body && response.body.data && response.body.data.token) {
  authToken = response.body.data.token;
}
```

**ä¿å­˜é€»è¾‘**ï¼š
1. **æ¡ä»¶åˆ¤æ–­**ï¼šä»…åœ¨æ»¡è¶³ `saveToken: true` ä¸”å“åº”åŒ…å«æœ‰æ•ˆä»¤ç‰Œæ—¶æ‰§è¡Œ
2. **æ•°æ®æå–**ï¼šä»å“åº”ä½“çš„ `data.token` å­—æ®µæå–ä»¤ç‰Œ
3. **å…¨å±€æ›´æ–°**ï¼šç«‹å³æ›´æ–°å…¨å±€ `authToken` å˜é‡ä¾›åç»­æµ‹è¯•ä½¿ç”¨

**ç« èŠ‚æ¥æº**
- [test.js](file://test.js#L75-L85)
- [src/routes/auth.ts](file://src/routes/auth.ts#L15-L40)

## HTTPè¯·æ±‚å°è£…

### makeRequest å‡½æ•°è®¾è®¡

æµ‹è¯•è„šæœ¬çš„æ ¸å¿ƒæ˜¯ `makeRequest` å‡½æ•°ï¼Œå®ƒå°è£…äº†æ‰€æœ‰ HTTP è¯·æ±‚çš„é€šç”¨é€»è¾‘ï¼š

```javascript
function makeRequest(options, data = null) {
  return new Promise((resolve, reject) => {
    const req = http.request(options, (res) => {
      let body = '';
      res.on('data', chunk => body += chunk);
      res.on('end', () => {
        try {
          const jsonBody = body ? JSON.parse(body) : null;
          resolve({ status: res.statusCode, body: jsonBody, headers: res.headers });
        } catch (e) {
          resolve({ status: res.statusCode, body: body, headers: res.headers });
        }
      });
    });

    req.on('error', reject);

    if (data) {
      req.write(JSON.stringify(data));
    }
    req.end();
  });
}
```

### è¯·æ±‚å¤„ç†æµç¨‹

```mermaid
flowchart TD
Start([å‘èµ·HTTPè¯·æ±‚]) --> CreateReq["åˆ›å»ºhttp.requestå¯¹è±¡"]
CreateReq --> SetupHandlers["è®¾ç½®äº‹ä»¶å¤„ç†å™¨"]
SetupHandlers --> DataHandler["ç›‘å¬'data'äº‹ä»¶<br/>ç´¯ç§¯å“åº”æ•°æ®"]
DataHandler --> EndHandler["ç›‘å¬'end'äº‹ä»¶<br/>æ•°æ®æ¥æ”¶å®Œæˆ"]
EndHandler --> ParseBody["å°è¯•è§£æJSONå“åº”"]
ParseBody --> Success{"è§£ææˆåŠŸ?"}
Success --> |æ˜¯| ReturnJson["è¿”å›JSONå¯¹è±¡"]
Success --> |å¦| ReturnRaw["è¿”å›åŸå§‹å­—ç¬¦ä¸²"]
ReturnJson --> ResolvePromise["resolve Promise"]
ReturnRaw --> ResolvePromise
CreateReq --> ErrorHandler["ç›‘å¬'error'äº‹ä»¶"]
ErrorHandler --> RejectPromise["reject Promise"]
ResolvePromise --> End([ç»“æŸ])
RejectPromise --> End
```

**å›¾è¡¨æ¥æº**
- [test.js](file://test.js#L45-L67)

### é”™è¯¯æ•è·æœºåˆ¶

```javascript
try {
  const response = await makeRequest(options, test.data);
  // å¤„ç†å“åº”...
} catch (error) {
  console.log(`âŒ ${test.name} - é”™è¯¯: ${error.message}`);
  failed++;
}
```

**é”™è¯¯å¤„ç†ç­–ç•¥**ï¼š
1. **Promise æ•è·**ï¼šä½¿ç”¨ `try-catch` æ•è·å¼‚æ­¥é”™è¯¯
2. **é”™è¯¯åˆ†ç±»**ï¼šåŒºåˆ†ç½‘ç»œé”™è¯¯å’Œä¸šåŠ¡é”™è¯¯
3. **è¯¦ç»†æŠ¥å‘Š**ï¼šæ˜¾ç¤ºå…·ä½“çš„é”™è¯¯æ¶ˆæ¯ä¾¿äºè°ƒè¯•
4. **ç»§ç»­æ‰§è¡Œ**ï¼šå³ä½¿æŸä¸ªæµ‹è¯•å¤±è´¥ï¼Œä»ç»§ç»­æ‰§è¡Œåç»­æµ‹è¯•

### å“åº”æ•°æ®å¤„ç†

```javascript
// éªŒè¯ç»“æœ
if (response.status === test.expectedStatus) {
  console.log(`âœ… ${test.name} - é€šè¿‡ (${response.status})`);
  passed++;
} else {
  console.log(`âŒ ${test.name} - å¤±è´¥ (æœŸæœ›: ${test.expectedStatus}, å®é™…: ${response.status})`);
  failed++;
}
```

**æ•°æ®éªŒè¯é€»è¾‘**ï¼š
1. **çŠ¶æ€ç æ¯”è¾ƒ**ï¼šä¸¥æ ¼åŒ¹é…æœŸæœ›çš„çŠ¶æ€ç 
2. **æˆåŠŸæ ‡è®°**ï¼šçŠ¶æ€ç åŒ¹é…æ—¶æ ‡è®°ä¸ºé€šè¿‡
3. **å¤±è´¥æŠ¥å‘Š**ï¼šè¯¦ç»†è¯´æ˜æœŸæœ›å€¼å’Œå®é™…å€¼çš„å·®å¼‚
4. **ç»Ÿè®¡æ›´æ–°**ï¼šè‡ªåŠ¨æ›´æ–°é€šè¿‡/å¤±è´¥è®¡æ•°å™¨

**ç« èŠ‚æ¥æº**
- [test.js](file://test.js#L45-L67)
- [test.js](file://test.js#L75-L105)

## æ‰§è¡Œæµç¨‹åˆ†æ

### ä¸»æ‰§è¡Œå‡½æ•°

```javascript
async function runTests() {
  console.log('ğŸš€ å¼€å§‹æ‰§è¡Œ Point-Tron ç³»ç»Ÿæµ‹è¯•\n');
  
  let passed = 0;
  let failed = 0;

  for (const test of tests) {
    // æµ‹è¯•æ‰§è¡Œé€»è¾‘...
  }

  console.log(`\nğŸ“‹ æµ‹è¯•ç»“æœ: ${passed} é€šè¿‡, ${failed} å¤±è´¥`);
  
  if (failed === 0) {
    console.log('ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼ç³»ç»Ÿè¿è¡Œæ­£å¸¸ã€‚');
  } else {
    console.log('âš ï¸  éƒ¨åˆ†æµ‹è¯•å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç³»ç»ŸçŠ¶æ€ã€‚');
  }
}
```

### æµ‹è¯•æ‰§è¡Œé¡ºåº

```mermaid
gantt
title æµ‹è¯•æ‰§è¡Œæ—¶é—´çº¿
dateFormat X
axisFormat %s
section åˆå§‹åŒ–é˜¶æ®µ
åŠ è½½é…ç½® :0, 1
åˆå§‹åŒ–å˜é‡ :1, 2
section æµ‹è¯•å¾ªç¯
å¥åº·æ£€æŸ¥ :2, 3
ç”¨æˆ·ç™»å½• :3, 5
åŒºå—ç»Ÿè®¡ :5, 7
ç³»ç»ŸçŠ¶æ€ :7, 9
RPCé…ç½® :9, 11
section ç»“æœæ±‡æ€»
ç”ŸæˆæŠ¥å‘Š :11, 12
```

**å›¾è¡¨æ¥æº**
- [test.js](file://test.js#L69-L137)

### å¹¶å‘å¤„ç†èƒ½åŠ›

è™½ç„¶å½“å‰æµ‹è¯•è„šæœ¬æ˜¯ä¸²è¡Œæ‰§è¡Œçš„ï¼Œä½†å…¶æ¶æ„è®¾è®¡æ”¯æŒå¹¶å‘æ‰©å±•ï¼š

```javascript
// å½“å‰å®ç°ï¼ˆä¸²è¡Œï¼‰
for (const test of tests) {
  await executeSingleTest(test);
}

// å¯æ‰©å±•ä¸ºå¹¶å‘ç‰ˆæœ¬
// const results = await Promise.all(tests.map(executeSingleTest));
```

**å¹¶å‘ä¼˜åŠ¿**ï¼š
1. **æ€§èƒ½æå‡**ï¼šå‡å°‘æ€»æµ‹è¯•æ—¶é—´
2. **èµ„æºåˆ©ç”¨**ï¼šæ›´é«˜æ•ˆåœ°ä½¿ç”¨ç½‘ç»œå¸¦å®½
3. **ç‹¬ç«‹æ€§**ï¼šå„æµ‹è¯•ç”¨ä¾‹ç›¸äº’ç‹¬ç«‹ï¼Œäº’ä¸å½±å“

**ç« èŠ‚æ¥æº**
- [test.js](file://test.js#L69-L137)

## è¾“å‡ºç»“æœè§£è¯»

### æˆåŠŸæµ‹è¯•è¾“å‡º

```
ğŸš€ å¼€å§‹æ‰§è¡Œ Point-Tron ç³»ç»Ÿæµ‹è¯•

âœ… å¥åº·æ£€æŸ¥ - é€šè¿‡ (200)
âœ… ç™»å½•æµ‹è¯• - é€šè¿‡ (200)
âœ… è·å–åŒºå—ç»Ÿè®¡ - é€šè¿‡ (200)
   ğŸ“Š ä»Šæ—¥ç»Ÿè®¡: æ€»è®¡1234, å•æ•°617, åŒæ•°617
âœ… è·å–ç³»ç»ŸçŠ¶æ€ - é€šè¿‡ (200)
âœ… è·å–RPCé…ç½® - é€šè¿‡ (200)

ğŸ“‹ æµ‹è¯•ç»“æœ: 5 é€šè¿‡, 0 å¤±è´¥
ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼ç³»ç»Ÿè¿è¡Œæ­£å¸¸ã€‚
```

### å¤±è´¥æµ‹è¯•è¾“å‡º

```
ğŸš€ å¼€å§‹æ‰§è¡Œ Point-Tron ç³»ç»Ÿæµ‹è¯•

âœ… å¥åº·æ£€æŸ¥ - é€šè¿‡ (200)
âŒ ç™»å½•æµ‹è¯• - å¤±è´¥ (æœŸæœ›: 200, å®é™…: 401)
âŒ è·å–åŒºå—ç»Ÿè®¡ - å¤±è´¥ (æœŸæœ›: 200, å®é™…: 401)
âŒ è·å–ç³»ç»ŸçŠ¶æ€ - å¤±è´¥ (æœŸæœ›: 200, å®é™…: 401)
âŒ è·å–RPCé…ç½® - å¤±è´¥ (æœŸæœ›: 200, å®é™…: 401)

ğŸ“‹ æµ‹è¯•ç»“æœ: 1 é€šè¿‡, 4 å¤±è´¥
âš ï¸  éƒ¨åˆ†æµ‹è¯•å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç³»ç»ŸçŠ¶æ€ã€‚
```

### é”™è¯¯æµ‹è¯•è¾“å‡º

```
ğŸš€ å¼€å§‹æ‰§è¡Œ Point-Tron ç³»ç»Ÿæµ‹è¯•

âœ… å¥åº·æ£€æŸ¥ - é€šè¿‡ (200)
âŒ ç™»å½•æµ‹è¯• - é”™è¯¯: connect ECONNREFUSED 127.0.0.1:3000
âŒ è·å–åŒºå—ç»Ÿè®¡ - é”™è¯¯: socket hang up
âŒ è·å–ç³»ç»ŸçŠ¶æ€ - é”™è¯¯: getaddrinfo ENOTFOUND localhost
âŒ è·å–RPCé…ç½® - é”™è¯¯: Request timeout

ğŸ“‹ æµ‹è¯•ç»“æœ: 1 é€šè¿‡, 4 å¤±è´¥
âš ï¸  éƒ¨åˆ†æµ‹è¯•å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç³»ç»ŸçŠ¶æ€ã€‚
```

### è¾“å‡ºæ ¼å¼è¯´æ˜

1. **æˆåŠŸæ ‡è®°**ï¼š`âœ…` è¡¨ç¤ºæµ‹è¯•é€šè¿‡
2. **å¤±è´¥æ ‡è®°**ï¼š`âŒ` è¡¨ç¤ºæµ‹è¯•å¤±è´¥æˆ–å‡ºç°é”™è¯¯
3. **çŠ¶æ€ä¿¡æ¯**ï¼šæ˜¾ç¤º HTTP çŠ¶æ€ç å’Œè¯¦ç»†ä¿¡æ¯
4. **ç»Ÿè®¡æ•°æ®**ï¼šå¯¹äºç‰¹å®šæ¥å£æ˜¾ç¤ºå…³é”®æ•°æ®æŒ‡æ ‡
5. **æ€»ç»“ä¿¡æ¯**ï¼šæœ€ç»ˆç»Ÿè®¡é€šè¿‡å’Œå¤±è´¥çš„æ•°é‡
6. **æ€»ä½“è¯„ä»·**ï¼šæ ¹æ®æµ‹è¯•ç»“æœç»™å‡ºç³»ç»ŸçŠ¶æ€è¯„ä¼°

**ç« èŠ‚æ¥æº**
- [test.js](file://test.js#L75-L137)

## æ•…éšœæ’é™¤æŒ‡å—

### å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

#### 1. æœåŠ¡å™¨æœªå¯åŠ¨

**ç—‡çŠ¶**ï¼šæ‰€æœ‰æµ‹è¯•éƒ½æ˜¾ç¤ºè¿æ¥é”™è¯¯
```
âŒ å¥åº·æ£€æŸ¥ - é”™è¯¯: connect ECONNREFUSED 127.0.0.1:3000
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦å¯åŠ¨
ps aux | grep node

# å¯åŠ¨æœåŠ¡å™¨
npm start

# æˆ–è€…å¼€å‘æ¨¡å¼å¯åŠ¨
npm run dev
```

#### 2. è®¤è¯å¤±è´¥

**ç—‡çŠ¶**ï¼šç™»å½•æµ‹è¯•å¤±è´¥æˆ–åç»­è®¤è¯ç›¸å…³æµ‹è¯•å¤±è´¥
```
âŒ ç™»å½•æµ‹è¯• - å¤±è´¥ (æœŸæœ›: 200, å®é™…: 401)
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥é»˜è®¤ç®¡ç†å‘˜å‡­æ®æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤æ•°æ®åº“ä¸­æ˜¯å¦å­˜åœ¨ç®¡ç†å‘˜ç”¨æˆ·
3. éªŒè¯ JWT å¯†é’¥é…ç½®æ˜¯å¦æ­£ç¡®

#### 3. æ•°æ®åº“è¿æ¥é—®é¢˜

**ç—‡çŠ¶**ï¼šç³»ç»ŸçŠ¶æ€æŸ¥è¯¢å¤±è´¥
```
âŒ è·å–ç³»ç»ŸçŠ¶æ€ - é”™è¯¯: Cannot read property 'isConnected' of undefined
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥æ•°æ®åº“æ–‡ä»¶è·¯å¾„é…ç½®
2. ç¡®è®¤æ•°æ®åº“æ–‡ä»¶å­˜åœ¨ä¸”å¯è®¿é—®
3. éªŒè¯æ•°æ®åº“è¿æ¥æ± é…ç½®

#### 4. ç½‘ç»œè¶…æ—¶é—®é¢˜

**ç—‡çŠ¶**ï¼šæŸäº›æµ‹è¯•å‡ºç°è¶…æ—¶é”™è¯¯
```
âŒ è·å–åŒºå—ç»Ÿè®¡ - é”™è¯¯: Request timeout
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ TRON RPC æœåŠ¡å¯ç”¨æ€§
2. è°ƒæ•´è¶…æ—¶é…ç½®å‚æ•°
3. æ£€æŸ¥ç½‘ç»œè¿æ¥ç¨³å®šæ€§

### è°ƒè¯•æŠ€å·§

#### å¯ç”¨è¯¦ç»†æ—¥å¿—

```javascript
// åœ¨ makeRequest ä¸­æ·»åŠ è°ƒè¯•ä¿¡æ¯
console.log(`Sending ${options.method} request to ${options.path}`);
console.log('Request headers:', options.headers);
console.log('Request body:', data);
```

#### ä½¿ç”¨è°ƒè¯•è„šæœ¬

ç³»ç»Ÿæä¾›äº†ä¸“é—¨çš„è°ƒè¯•è„šæœ¬ `debug-api.js`ï¼Œå¯ä»¥å•ç‹¬æµ‹è¯•å„ä¸ª API æ¥å£ï¼š

```bash
node debug-api.js
```

#### æ£€æŸ¥ç³»ç»ŸçŠ¶æ€

```javascript
// åœ¨æµ‹è¯•è„šæœ¬ä¸­æ·»åŠ é¢å¤–çš„çŠ¶æ€æ£€æŸ¥
console.log('System status:', response.body.data);
```

**ç« èŠ‚æ¥æº**
- [test.js](file://test.js#L75-L137)
- [debug-api.js](file://debug-api.js#L1-L117)

## æœ€ä½³å®è·µå»ºè®®

### æµ‹è¯•è„šæœ¬ç»´æŠ¤

#### 1. ç‰ˆæœ¬æ§åˆ¶

```javascript
// æ·»åŠ ç‰ˆæœ¬ä¿¡æ¯
const TEST_VERSION = '1.0.0';
console.log(`ğŸ§ª æµ‹è¯•è„šæœ¬ç‰ˆæœ¬: ${TEST_VERSION}`);
```

#### 2. é…ç½®å¤–éƒ¨åŒ–

```javascript
// ä½¿ç”¨ç¯å¢ƒå˜é‡é…ç½®
const BASE_URL = process.env.TEST_BASE_URL || 'http://localhost:3000';
const ADMIN_CREDENTIALS = {
  username: process.env.ADMIN_USERNAME || 'admin',
  password: process.env.ADMIN_PASSWORD || 'admin123'
};
```

#### 3. æµ‹è¯•æ•°æ®ç®¡ç†

```javascript
// ä½¿ç”¨æµ‹è¯•æ•°æ®å·¥å‚
function createTestData(type) {
  switch (type) {
    case 'user':
      return {
        username: 'test_user_' + Date.now(),
        password: 'test_password'
      };
    case 'block':
      return {
        blockNumber: Date.now(),
        blockHash: '0x' + Math.random().toString(16).substring(2, 10)
      };
  }
}
```

### æµ‹è¯•è¦†ç›–ç‡ä¼˜åŒ–

#### 1. æ·»åŠ æ›´å¤šæµ‹è¯•åœºæ™¯

```javascript
// å¢åŠ è¾¹ç•Œæ¡ä»¶æµ‹è¯•
{
  name: 'æ— æ•ˆç™»å½•',
  method: 'POST',
  path: '/api/auth/login',
  data: { username: 'admin', password: 'wrong_password' },
  expectedStatus: 401
}

// å¢åŠ é”™è¯¯å¤„ç†æµ‹è¯•
{
  name: 'ä¸å­˜åœ¨çš„èµ„æº',
  method: 'GET',
  path: '/api/nonexistent',
  expectedStatus: 404
}
```

#### 2. å‚æ•°åŒ–æµ‹è¯•

```javascript
// ä½¿ç”¨å‚æ•°åŒ–æµ‹è¯•æé«˜æ•ˆç‡
const testScenarios = [
  { username: 'admin', password: 'admin123', expected: 200 },
  { username: 'admin', password: '', expected: 400 },
  { username: '', password: 'admin123', expected: 400 }
];
```

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

#### 1. å¹¶å‘æµ‹è¯•æ‰§è¡Œ

```javascript
// æ”¹è¿›åçš„å¹¶å‘ç‰ˆæœ¬
async function runTestsConcurrent() {
  const testPromises = tests.map(async (test) => {
    try {
      const result = await executeSingleTest(test);
      return { ...result, passed: true };
    } catch (error) {
      return { test, error, passed: false };
    }
  });
  
  const results = await Promise.all(testPromises);
  return results;
}
```

#### 2. ç¼“å­˜è®¤è¯ä»¤ç‰Œ

```javascript
// æ·»åŠ ä»¤ç‰Œç¼“å­˜æœºåˆ¶
let authTokenCache = null;
let cacheTimestamp = 0;

function getCachedAuthToken() {
  const now = Date.now();
  const cacheDuration = 30 * 60 * 1000; // 30åˆ†é’Ÿ
  
  if (authTokenCache && (now - cacheTimestamp) < cacheDuration) {
    return authTokenCache;
  }
  
  return null;
}
```

### ç›‘æ§é›†æˆ

#### 1. æ·»åŠ ç›‘æ§æŒ‡æ ‡

```javascript
// è®°å½•æµ‹è¯•æ‰§è¡Œæ—¶é—´
const startTime = Date.now();
await runTests();
const duration = Date.now() - startTime;

console.log(`â±ï¸  æµ‹è¯•æ€»è€—æ—¶: ${duration}ms`);
```

#### 2. é›†æˆ CI/CD

```yaml
# GitHub Actions ç¤ºä¾‹
name: Run Tests
on: [push, pull_request]
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Setup Node.js
        uses: actions/setup-node@v2
        with:
          node-version: '16'
      - name: Install dependencies
        run: npm install
      - name: Run tests
        run: node test.js
```

è¿™äº›æœ€ä½³å®è·µå¯ä»¥å¸®åŠ©æ‚¨æ›´å¥½åœ°ç»´æŠ¤å’Œæ‰©å±•æµ‹è¯•è„šæœ¬ï¼Œç¡®ä¿ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚